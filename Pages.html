<?php
// Vérifie si l'utilisateur est connecté
session_start();
if(!isset($_SESSION['user'])){
  header("Location: login.php");
}

// Inclut le fichier de configuration de la base de données
require_once 'config.php';

// Récupère les données du formulaire
if($_SERVER['REQUEST_METHOD'] == 'POST'){
  $title = $_POST['title'];
  $content = $_POST['content'];

  // Vérifie si les champs sont vides
  if(empty($title) || empty($content)){
    $error = "Veuillez remplir tous les champs";
  } else {
    // Prépare la requête SQL pour insérer les données dans la base de données
    $stmt = $pdo->prepare("INSERT INTO pages (title, content) VALUES (:title, :content)");
    $stmt->execute(['title' => $title, 'content' => $content]);
    $success = "La page a été créée avec succès";
  }
}

// Affiche le formulaire pour créer une page
?>

<!DOCTYPE html>
<html>
<head>
  <title>Créer une page</title>
</head>
<body>
  <h1>Créer une page</h1>

  <?php if(isset($error)): ?>
    <p><?php echo $error; ?></p>
  <?php endif; ?>

  <?php if(isset($success)): ?>
    <p><?php echo $success; ?></p>
  <?php endif; ?>

  <form method="POST">
    <label for="title">Titre :</label>
    <input type="text" id="title" name="title"><br><br>

    <label for="content">Contenu :</label>
    <textarea id="content" name="content"></textarea><br><br>

    <button type="submit">Créer la page</button>
  </form>
</body>
</html>
